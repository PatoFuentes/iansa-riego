{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\ud83c\udf3f Plataforma de Riego - Documentaci\u00f3n T\u00e9cnica","text":"<p>Bienvenido a la documentaci\u00f3n oficial del proyecto Plataforma de Riego, una soluci\u00f3n para la gesti\u00f3n de consumo de agua en zonas agr\u00edcolas utilizando datos meteorol\u00f3gicos.</p>"},{"location":"#indice","title":"\ud83d\udcda \u00cdndice","text":"<ul> <li>Introducci\u00f3n</li> <li>Requisitos</li> <li>Estructura del Proyecto</li> <li>Despliegue Local</li> <li>Despliegue en Producci\u00f3n (GCP)</li> <li>CI/CD con GitHub Actions</li> <li>Crawler Meteorol\u00f3gico</li> <li>Frontend Angular</li> <li>Backend Node.js</li> <li>Variables de Entorno</li> </ul>"},{"location":"#introduccion","title":"Introducci\u00f3n","text":"<p>La plataforma permite visualizar y generar recomendaciones de riego semanal con base en datos clim\u00e1ticos extra\u00eddos de estaciones meteorol\u00f3gicas de Chile.</p>"},{"location":"#requisitos","title":"Requisitos","text":"<ul> <li>Node.js v22</li> <li>Angular CLI 19+</li> <li>MySQL/MariaDB</li> <li>Cuenta en Google Cloud Platform</li> <li>Docker</li> </ul>"},{"location":"#estructura-del-proyecto","title":"Estructura del Proyecto","text":"<pre><code>\u251c\u2500\u2500 backend/              # API REST y l\u00f3gica del crawler\n\u2502   \u251c\u2500\u2500 crawlerINIA.js    # Crawler para ETo semanal\n\u2502   \u2514\u2500\u2500 server.js         # Express server principal\n\u2502\n\u251c\u2500\u2500 frontend/             # Aplicaci\u00f3n Angular SPA\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u2514\u2500\u2500 app/\n\u2502           \u251c\u2500\u2500 features/ # Componentes principales (zonas, regiones, usuarios, etc.)\n\u2502           \u2514\u2500\u2500 core/     # Servicios, guards y helpers\n\u2502\n\u251c\u2500\u2500 cloudbuild.yaml       # Script de despliegue autom\u00e1tico\n\u251c\u2500\u2500 .github/workflows/    # GitHub Actions para CI/CD y tests\n\u2514\u2500\u2500 docs/                 # Documentaci\u00f3n Markdown (esta carpeta)\n</code></pre>"},{"location":"#despliegue-local","title":"Despliegue Local","text":""},{"location":"#backend","title":"Backend","text":"<pre><code>cd backend\nnpm install\nnode server.js\n</code></pre>"},{"location":"#frontend","title":"Frontend","text":"<pre><code>cd frontend\nnpm install\nnpm run start\n</code></pre>"},{"location":"#acceso","title":"Acceso:","text":"<ul> <li>Frontend: <code>http://localhost:4200</code></li> <li>Backend API: <code>http://localhost:3000</code></li> </ul>"},{"location":"#despliegue-en-produccion-gcp","title":"Despliegue en Producci\u00f3n (GCP)","text":"<ol> <li>Crear proyecto en Google Cloud.</li> <li>Habilitar servicios:</li> <li>Cloud Run</li> <li>Cloud SQL</li> <li>Cloud Build</li> <li>Subir <code>credentials.json</code> como secreto <code>GCP_SA_KEY</code> en GitHub.</li> <li>Configurar <code>cloudbuild.yaml</code> y <code>deploy.yaml</code>.</li> <li>Push a <code>main</code> dispara el despliegue.</li> </ol>"},{"location":"#cicd-con-github-actions","title":"CI/CD con GitHub Actions","text":"<ul> <li><code>test.yaml</code>: Lint y pruebas unitarias al hacer push/pull_request</li> <li><code>deploy.yaml</code>: Despliegue completo solo en la rama <code>main</code></li> </ul>"},{"location":"#crawler-meteorologico","title":"Crawler Meteorol\u00f3gico","text":"<ul> <li>Archivo: <code>backend/crawlerINIA.js</code></li> <li>Funciones:</li> <li>Consulta a agrometeorolog\u00eda.cl</li> <li>Extrae ETo diario</li> <li>Promedia y formatea datos para recomendaci\u00f3n</li> </ul>"},{"location":"#frontend-angular","title":"Frontend Angular","text":"<ul> <li>Carpeta <code>frontend/</code></li> <li>Componentes clave:</li> <li><code>zona-view</code>: Visualizaci\u00f3n de clima, recomendaciones y consumo</li> <li><code>usuario-index</code>: Administraci\u00f3n de usuarios</li> <li>Servicios importantes:</li> <li><code>CrawlerService</code>: Obtiene datos clim\u00e1ticos de backend</li> </ul>"},{"location":"#backend-nodejs","title":"Backend Node.js","text":"<ul> <li>Archivo principal: <code>server.js</code></li> <li>Rutas <code>/api/clima-semanal</code>, <code>/api/eto</code>, etc.</li> <li>Conexi\u00f3n a Cloud SQL por socket <code>/cloudsql/...</code></li> </ul>"},{"location":"#variables-de-entorno","title":"Variables de Entorno","text":"<p>Crear archivo <code>.env</code> en <code>backend/</code>:</p> <pre><code>DB_HOST=/cloudsql/id-pagina-riego:us-central1:id-bd-riego\nDB_USER=root\nDB_PASSWORD=tu_clave\nDB_NAME=iansa_riego\nPORT=3000\n</code></pre>"},{"location":"#autor","title":"\ud83d\udccc Autor","text":"<p>Patricio Fuentes \u2014 Ingenier\u00eda Civil Inform\u00e1tica, Universidad Adventista de Chile.</p>"},{"location":"backend/","title":"\u2699\ufe0f Backend - API y Procesamiento de Datos","text":"<p>El backend est\u00e1 desarrollado con Node.js y utiliza Express como framework principal. Proporciona una API REST para gestionar zonas, usuarios, datos clim\u00e1ticos y recomendaciones de riego.</p>"},{"location":"backend/#estructura-del-backend","title":"\ud83d\uddc2 Estructura del Backend","text":"<pre><code>backend/\n\u251c\u2500\u2500 server.js           # Archivo principal del servidor Express\n\u251c\u2500\u2500 crawlerINIA.js      # Crawler para obtener ETo y clima semanal\n\u251c\u2500\u2500 routes/             # Rutas de la API (pendiente modularizaci\u00f3n)\n\u251c\u2500\u2500 controllers/        # L\u00f3gica (puede modularizarse)\n\u251c\u2500\u2500 .env                # Variables de entorno\n\u251c\u2500\u2500 Dockerfile          # Imagen para desplegar en Cloud Run\n</code></pre>"},{"location":"backend/#rutas-principales","title":"\ud83d\udce1 Rutas Principales","text":"M\u00e9todo Endpoint Descripci\u00f3n GET /api/zonas Obtener zonas de riego GET /api/usuarios Obtener usuarios POST /api/recomendaciones Crear una nueva recomendaci\u00f3n GET /api/eto Ejecuta el crawler INIA para ETo semanal GET /api/clima-semanal Ejecuta el crawler para clima semanal"},{"location":"backend/#crawler-inia","title":"\ud83d\udd04 Crawler INIA","text":"<p>Archivo: <code>crawlerINIA.js</code></p> <ul> <li>Usa <code>puppeteer</code> para automatizar la obtenci\u00f3n de ETo y Precipitaci\u00f3n desde agrometeorologia.cl.</li> <li>Se ejecuta cuando se accede a <code>/api/eto</code> o <code>/api/clima-semanal</code>.</li> <li>El archivo es importado en <code>server.js</code> y no tiene un endpoint separado.</li> </ul>"},{"location":"backend/#variables-de-entorno-env","title":"\ud83d\udd10 Variables de Entorno (.env)","text":"<pre><code>DB_HOST=localhost\nDB_PORT=3306\nDB_USER=root\nDB_PASSWORD=\nDB_NAME=iansa_riego\nPORT=3000\n</code></pre>"},{"location":"backend/#dockerfile-resumen","title":"\ud83d\udc33 Dockerfile (Resumen)","text":"<pre><code>FROM node:22\nWORKDIR /app\nCOPY . .\nRUN npm install\nEXPOSE 3000\nCMD [\"node\", \"server.js\"]\n</code></pre> <p>Adem\u00e1s se crea la carpeta <code>/cloudsql</code> en tiempo de build para conexi\u00f3n con Cloud SQL en producci\u00f3n.</p>"},{"location":"backend/#despliegue-en-cloud-run","title":"\u2601\ufe0f Despliegue en Cloud Run","text":"<ul> <li>Expone el backend en el puerto <code>3000</code>, mapeado autom\u00e1ticamente a <code>8080</code> por Cloud Run.</li> <li>Usa variables de entorno definidas en el entorno de ejecuci\u00f3n.</li> <li>Se construye y despliega desde <code>cloudbuild.yaml</code>.</li> </ul> <p>\u00bfPreguntas sobre el backend? Puedes revisarlo en <code>server.js</code> y <code>crawlerINIA.js</code>.</p>"},{"location":"crawler/","title":"\ud83e\udd16 Crawler INIA - Recolecci\u00f3n de Datos Agroclim\u00e1ticos","text":"<p>El archivo <code>crawlerINIA.js</code> es un m\u00f3dulo que se encarga de obtener datos semanales de ETo y precipitaci\u00f3n desde el sitio web de agrometeorologia.cl. Esta informaci\u00f3n es esencial para generar recomendaciones de riego precisas.</p>"},{"location":"crawler/#tecnologias-usadas","title":"\ud83e\udde9 Tecnolog\u00edas Usadas","text":"<ul> <li><code>puppeteer</code>: automatiza la navegaci\u00f3n en sitios web para simular un usuario real.</li> <li><code>cheerio</code>: permite hacer scraping de forma similar a jQuery (si se necesitara).</li> <li>JSON remoto: se extraen datos desde el API p\u00fablica de estaciones con estructura <code>STACK-DAY</code>.</li> </ul>"},{"location":"crawler/#logica-general-del-crawler","title":"\ud83e\udde0 L\u00f3gica General del Crawler","text":"<ol> <li>Se recibe el <code>estacion_id</code> y <code>estacion_api</code> como par\u00e1metros desde el frontend.</li> <li>Se navega al sitio y se selecciona la estaci\u00f3n meteorol\u00f3gica correspondiente.</li> <li>Se obtiene el JSON con los valores diarios de ETo y Precipitaci\u00f3n. </li> <li>Se extraen:</li> <li>Fechas</li> <li>Suma total de ETo (<code>EToTotal</code>)</li> <li>Total de precipitaci\u00f3n</li> <li>Semana de inicio y fin (<code>semana_inicio</code>, <code>semana_fin</code>)</li> <li>Se devuelve un objeto JSON con los resultados listos para ser utilizados por el frontend.</li> </ol>"},{"location":"crawler/#archivo-crawleriniajs","title":"\ud83d\udce6 Archivo <code>crawlerINIA.js</code>","text":""},{"location":"crawler/#funciones-exportadas","title":"Funciones exportadas","text":"<ul> <li><code>obtenerDatosETo(estacion_id, estacion_api)</code> \u2192 para <code>/api/eto</code></li> <li><code>obtenerClimaSemanal(estacion_id, estacion_api)</code> \u2192 para <code>/api/clima-semanal</code></li> </ul> <p>Ambas funciones son utilizadas desde <code>server.js</code> como middlewares de endpoints GET.</p>"},{"location":"crawler/#ejemplo-de-consumo","title":"\ud83d\udd0c Ejemplo de Consumo","text":"<p>Desde Angular (servicio <code>CrawlerService</code>):</p> <pre><code>this.http.get(`/api/eto?estacion_id=1234&amp;estacion_api=INIA`).subscribe(...)\n</code></pre> <p>Desde backend (en <code>server.js</code>):</p> <pre><code>const { obtenerDatosETo } = require(\"./crawlerINIA\");\napp.get(\"/api/eto\", async (req, res) =&gt; {\n  const data = await obtenerDatosETo(estacion_id, api);\n  res.json(data);\n});\n</code></pre>"},{"location":"crawler/#consideraciones","title":"\ud83d\udea7 Consideraciones","text":"<ul> <li>Algunas estaciones requieren esperar a que el formulario se procese. Se maneja con <code>waitForSelector()</code>.</li> <li>Si faltan muchos valores de ETo, el sistema los reemplaza por el promedio (m\u00e1ximo 2 datos faltantes).</li> <li>Si hay m\u00e1s de 2 valores faltantes, el sistema cancela la generaci\u00f3n autom\u00e1tica y sugiere ingresar manualmente.</li> <li>El JSON interceptado de INIA entrega valores de los \u00faltimos 7 d\u00edas.</li> </ul>"},{"location":"crawler/#proximas-mejoras","title":"\ud83e\uddea Pr\u00f3ximas Mejoras","text":"<ul> <li>Cache de resultados para evitar m\u00faltiples scrapes en un mismo d\u00eda.</li> <li>Validaciones extras para estaciones nuevas.</li> <li>Registro de logs de uso del crawler.</li> <li>Usar una API proporcionada directamente por INIA</li> </ul>"},{"location":"database/","title":"\ud83d\uddc4\ufe0f Base de Datos - <code>iansa_riego</code>","text":"<p>La base de datos utilizada por el sistema se llama <code>iansa_riego</code> y est\u00e1 dise\u00f1ada en MySQL/MariaDB. Contiene las entidades necesarias para modelar zonas de riego, usuarios, recomendaciones, consumo de agua, estaciones meteorol\u00f3gicas y temporadas.</p>"},{"location":"database/#esquema-general","title":"\ud83e\uddf1 Esquema General","text":"<pre><code>\ud83d\udce6 iansa_riego\n\u251c\u2500\u2500 usuarios\n\u251c\u2500\u2500 regiones\n\u251c\u2500\u2500 zonas\n\u251c\u2500\u2500 temporadas\n\u251c\u2500\u2500 recomendaciones\n\u251c\u2500\u2500 consumo_agua\n</code></pre>"},{"location":"database/#tablas-principales","title":"\ud83d\udccb Tablas Principales","text":""},{"location":"database/#usuarios","title":"\ud83d\udd10 <code>usuarios</code>","text":"Campo Tipo Descripci\u00f3n rut VARCHAR(12) Identificador \u00fanico nombre VARCHAR(100) Nombre completo telefono VARCHAR(20) Tel\u00e9fono de contacto correo VARCHAR(100) Correo electr\u00f3nico (login) tipo ENUM <code>administrador</code> / <code>tecnico</code> estado TINYINT 1 = Activo, 0 = Inactivo contrasenia TEXT Hash de contrase\u00f1a"},{"location":"database/#regiones-y-zonas","title":"\ud83c\udf0e <code>regiones</code> y <code>zonas</code>","text":"<p><code>regiones</code> define agrupaciones geogr\u00e1ficas. <code>zonas</code> representa \u00e1reas espec\u00edficas de riego.</p> Campo en zonas Tipo Descripci\u00f3n id INT Identificador nombre VARCHAR(100) Nombre de la zona region_id FK Relaci\u00f3n a <code>regiones</code> estacion_id VARCHAR(50) ID de estaci\u00f3n agrometeorol\u00f3gica estacion_api VARCHAR(10) Fuente de datos (<code>INIA</code>, etc.) latitud DECIMAL Coordenada geogr\u00e1fica longitud DECIMAL Coordenada geogr\u00e1fica activa BOOLEAN Estado l\u00f3gico"},{"location":"database/#temporadas","title":"\ud83d\udcc6 <code>temporadas</code>","text":"Campo Tipo Descripci\u00f3n id INT ID autoincremental nombre VARCHAR(100) Ej: \"Primavera 2025\" fecha_inicio DATE Inicio de temporada fecha_fin DATE Fin de temporada activa BOOLEAN Si est\u00e1 disponible para uso"},{"location":"database/#consumo_agua","title":"\ud83d\udca7 <code>consumo_agua</code>","text":"<p>Esta tabla guarda los datos semanales de consumo y ETo calculados o importados.</p> Campo Tipo Descripci\u00f3n zona_id FK Relaci\u00f3n a <code>zonas</code> semana_inicio DATE Fecha de inicio del periodo semanal semana_fin DATE Fecha de t\u00e9rmino del periodo semanal eto FLOAT Evapotranspiraci\u00f3n potencial semanal kc FLOAT Coeficiente de cultivo etc FLOAT Evapotranspiraci\u00f3n del cultivo riego_aspersor FLOAT Recomendaci\u00f3n en litros riego_goteo FLOAT Recomendaci\u00f3n en litros riego_pivote FLOAT Recomendaci\u00f3n en litros precipitacion FLOAT Precipitaci\u00f3n efectiva semanal temporada_id FK (opcional) Asociada a una temporada"},{"location":"database/#recomendaciones","title":"\ud83d\udcc8 <code>recomendaciones</code>","text":"<p>Guarda las recomendaciones generadas para riego basadas en ETo, kc y precipitaci\u00f3n.</p> Campo Tipo Descripci\u00f3n zona_id FK Relaci\u00f3n con la zona semana_inicio DATE Semana analizada semana_fin DATE Fin de semana etc FLOAT ETc calculada kc FLOAT Coeficiente utilizado precipitacion FLOAT Precipitaci\u00f3n total riego_goteo FLOAT Recomendaci\u00f3n en litros riego_pivote FLOAT Recomendaci\u00f3n en litros riego_aspersor FLOAT Recomendaci\u00f3n en litros creado_en TIMESTAMP Fecha de creaci\u00f3n"},{"location":"database/#consideraciones-de-seguridad","title":"\ud83d\udd10 Consideraciones de Seguridad","text":"<ul> <li>Las contrase\u00f1as se almacenan hasheadas.</li> <li>Acceso diferenciado por tipo de usuario (<code>tecnico</code>, <code>administrador</code>).</li> <li>Validaciones y filtros por zona y estado activo en el backend.</li> </ul>"},{"location":"database/#posibles-mejoras","title":"\ud83e\uddea Posibles Mejoras","text":"<ul> <li>Historial de ejecuciones del crawler.</li> <li>Trazabilidad de cambios en <code>zonas</code> y <code>usuarios</code>.</li> <li>Registro de recomendaciones manuales vs autom\u00e1ticas.</li> </ul> <p>Esta base de datos est\u00e1 pensada para escalar f\u00e1cilmente en nuevos m\u00f3dulos como sensores, pagos o auditor\u00edas.</p>"},{"location":"deploy/","title":"\ud83d\ude80 Despliegue del Proyecto en Google Cloud Platform (GCP)","text":"<p>Esta secci\u00f3n describe el proceso de despliegue autom\u00e1tico del sistema de riego usando Docker, GitHub Actions y Google Cloud Platform, espec\u00edficamente con Cloud Run.</p>"},{"location":"deploy/#servicios-utilizados-en-gcp","title":"\ud83c\udf10 Servicios Utilizados en GCP","text":"Servicio Uso principal Cloud Run Hospedaje de contenedores para frontend/backend Cloud Build Automatiza los builds de Docker Cloud SQL Base de datos MySQL Artifact Registry Almac\u00e9n de im\u00e1genes Docker IAM Permisos y cuentas de servicio Cloud Logging Logs de ejecuci\u00f3n de los servicios"},{"location":"deploy/#estructura-del-despliegue","title":"\ud83e\uddf1 Estructura del Despliegue","text":"<pre><code>.github/workflows/\n\u251c\u2500\u2500 deploy.yaml       # CI/CD para build + deploy\n\u251c\u2500\u2500 test.yaml         # Lint y pruebas autom\u00e1ticas\n\ncloudbuild.yaml        # Build y despliegue en Cloud Run\nfrontend/Dockerfile    # Imagen frontend Angular\nbackend/Dockerfile     # Imagen backend Express\n</code></pre>"},{"location":"deploy/#archivos-clave","title":"\u2699\ufe0f Archivos Clave","text":""},{"location":"deploy/#cloudbuildyaml","title":"\ud83d\udcc1 <code>cloudbuild.yaml</code>","text":"<p>Define los pasos para:</p> <ul> <li>Build backend y frontend (Docker)</li> <li>Push a Artifact Registry</li> <li>Deploy en Cloud Run</li> </ul> <pre><code>steps:\n  - name: 'gcr.io/cloud-builders/docker'\n    args: ['build', '-t', 'gcr.io/PROYECTO/backend-riego', '.']\n    dir: 'backend'\n  - name: 'gcr.io/cloud-builders/docker'\n    args: ['build', '-t', 'gcr.io/PROYECTO/frontend-riego', '.']\n    dir: 'frontend'\n  ...\n</code></pre>"},{"location":"deploy/#githubworkflowsdeployyaml","title":"\ud83d\udcc1 <code>.github/workflows/deploy.yaml</code>","text":"<p>Se ejecuta en cada <code>push</code> a <code>main</code>. Autentica con GCP y lanza <code>cloudbuild.yaml</code>.</p> <pre><code>on:\n  push:\n    branches:\n      - main\n</code></pre>"},{"location":"deploy/#secrets-en-github","title":"\ud83d\udd10 Secrets en GitHub","text":"Nombre Descripci\u00f3n <code>GCP_SA_KEY</code> JSON de la cuenta de servicio con permisos a Cloud Run, Build y Storage"},{"location":"deploy/#configuraciones-relevantes","title":"\u2601\ufe0f Configuraciones Relevantes","text":"<ul> <li>Cada microservicio (frontend y backend) tiene su propia imagen Docker.</li> <li>El backend escucha en <code>PORT=3000</code>, pero Cloud Run lo redirige a <code>8080</code>.</li> <li>Las variables de entorno del backend se configuran directamente en la consola de Cloud Run.</li> </ul>"},{"location":"deploy/#pruebas-automatizadas","title":"\ud83e\uddea Pruebas Automatizadas","text":"<p>Se ejecutan antes del despliegue en el workflow <code>test.yaml</code>:</p> <pre><code>on:\n  push:\n    branches:\n      - main\n  pull_request:\n</code></pre>"},{"location":"deploy/#requisitos-previos","title":"\u2705 Requisitos Previos","text":"<ol> <li>Activar APIs en GCP:</li> <li>Cloud Run</li> <li>Cloud Build</li> <li>Artifact Registry</li> <li> <p>Cloud SQL Admin</p> </li> <li> <p>Crear cuenta de servicio y otorgar permisos:</p> </li> <li>Cloud Run Admin</li> <li>Cloud Build Editor</li> <li> <p>Storage Admin (para logs y fuentes)</p> </li> <li> <p>Agregar JSON de cuenta como secret en GitHub.</p> </li> </ol>"},{"location":"deploy/#resultado","title":"\ud83d\udce6 Resultado","text":"<ul> <li>Producci\u00f3n disponible en:</li> <li>Frontend: <code>https://frontend-riego-xxx.run.app</code></li> <li>Backend: <code>https://backend-riego-xxx.run.app</code></li> </ul>"},{"location":"frontend/","title":"\ud83e\uddf1 Frontend - Plataforma de Riego","text":""},{"location":"frontend/#estructura-del-proyecto-angular","title":"\ud83d\udce6 Estructura del Proyecto Angular","text":"<pre><code>frontend/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 app/\n\u2502   \u2502   \u251c\u2500\u2500 core/              # Servicios, guards, interceptores\n\u2502   \u2502   \u251c\u2500\u2500 features/          # M\u00f3dulos funcionales (usuarios, zonas, regiones, etc.)\n\u2502   \u2502   \u251c\u2500\u2500 shared/            # Componentes reutilizables (login, navbar, etc.)\n\u2502   \u2502   \u251c\u2500\u2500 app.component.ts   # Componente principal\n\u2502   \u2502   \u251c\u2500\u2500 app.routes.ts      # Configuraci\u00f3n de rutas\n\u2502   \u251c\u2500\u2500 environments/          # Configuraciones de entorno\n\u251c\u2500\u2500 angular.json               # Configuraci\u00f3n Angular CLI\n\u251c\u2500\u2500 tsconfig.*.json            # Configuraci\u00f3n TypeScript\n</code></pre>"},{"location":"frontend/#modulos-funcionales-features","title":"\ud83d\udcc1 M\u00f3dulos Funcionales (<code>features/</code>)","text":"<p>Contienen cada parte principal de la app:</p> <ul> <li><code>usuarios/</code>: vista y CRUD de usuarios</li> <li><code>regiones/</code>: administraci\u00f3n de regiones</li> <li><code>zonas/</code>: zonas de riego y sus datos clim\u00e1ticos</li> <li><code>conceptos/</code>: definici\u00f3n de conceptos de riego</li> <li><code>temporadas/</code>: manejo de temporadas activas</li> </ul>"},{"location":"frontend/#ruteo-approutests","title":"\ud83d\udd04 Ruteo (<code>app.routes.ts</code>)","text":"<p>Se definen las rutas de cada m\u00f3dulo. Algunas rutas est\u00e1n protegidas con un <code>AuthGuard</code>:</p> <pre><code>export const routes: Routes = [\n  { path: '', component: HomeComponent },\n  { path: 'login', component: LoginComponent },\n  { path: 'conceptos', component: ConceptoViewComponent },\n  { path: 'regiones', children: regionesRoutes }, // subrutas de Regiones\n  { path: 'zonas', children: zonasRoutes },\n  { path: 'usuarios', canActivate: [AuthGuard], children: usuariosRoutes },\n  { path: 'temporadas', canActivate: [AuthGuard], children: temporadasRoutes },\n];\n</code></pre>"},{"location":"frontend/#autenticacion","title":"\ud83d\udd10 Autenticaci\u00f3n","text":"<ul> <li>Se usa <code>AuthService</code> para manejar login/logout.</li> <li>El login se realiza mediante correo y contrase\u00f1a.</li> <li>Los roles (<code>t\u00e9cnico</code>, <code>administrador</code>) determinan acceso en la navbar.</li> </ul>"},{"location":"frontend/#servicios-importantes","title":"\ud83d\udd27 Servicios Importantes","text":"<ul> <li><code>CrawlerService</code>: obtiene datos de ETo y clima semanal desde el backend.</li> <li><code>UsuarioService</code>: CRUD de usuarios.</li> <li><code>ZonaService</code>: obtiene zonas, clima, consumo, recomendaciones.</li> </ul>"},{"location":"frontend/#entornos","title":"\ud83c\udf10 Entornos","text":"<ul> <li><code>environment.ts</code>: para desarrollo (<code>localhost</code>)</li> <li><code>environment.prod.ts</code>: producci\u00f3n (<code>Cloud Run</code>)</li> </ul>"},{"location":"usage/","title":"\ud83d\udcd8 Gu\u00eda de Uso del Sistema de Riego","text":"<p>Esta secci\u00f3n detalla c\u00f3mo utilizar la plataforma web de gesti\u00f3n de consumo de agua, desde el inicio de sesi\u00f3n hasta la generaci\u00f3n de recomendaciones.</p>"},{"location":"usage/#1-iniciar-sesion","title":"\ud83d\udd10 1. Iniciar Sesi\u00f3n","text":"<ul> <li>Haz clic en el bot\u00f3n \u2630 y luego en \"Iniciar Sesi\u00f3n\".</li> <li>Ingresa tu correo y contrase\u00f1a.</li> <li>Solo los usuarios activos pueden ingresar.</li> </ul> <p>Tipos de usuario:</p> <ul> <li> <p>\ud83d\udc68\u200d\ud83d\udcbc Administrador: acceso completo (usuarios, zonas, regiones).</p> </li> <li> <p>\ud83d\udc77 T\u00e9cnico: acceso restringido (zonas, clima, consumo).</p> </li> </ul>"},{"location":"usage/#2-gestion-de-regiones-y-zonas","title":"\ud83c\udf0d 2. Gesti\u00f3n de Regiones y Zonas","text":""},{"location":"usage/#regiones","title":"Regiones","text":"<ul> <li>Desde el men\u00fa lateral, selecciona Regiones.</li> <li>Puedes ver una lista con el nombre y cantidad de zonas asociadas.</li> </ul>"},{"location":"usage/#zonas","title":"Zonas","text":"<ul> <li>En la vista de una regi\u00f3n, ver\u00e1s la lista de zonas asociadas.</li> <li>Acciones disponibles:</li> <li>Crear nueva zona</li> <li>Desactivar zona (solo admin)</li> <li>Ver detalles de zona (redirige a ZonaView)</li> </ul>"},{"location":"usage/#3-vista-de-zona-zonaview","title":"\ud83d\udccd 3. Vista de Zona (<code>ZonaView</code>)","text":"<p>Al ingresar a una zona, accedes a la secci\u00f3n central del sistema:</p>"},{"location":"usage/#paneles-disponibles","title":"Paneles disponibles:","text":""},{"location":"usage/#1-datos-generales","title":"1. \ud83d\udd22 Datos Generales","text":"<ul> <li>Informaci\u00f3n de nombre, estaci\u00f3n meteorol\u00f3gica, coordenadas.</li> </ul>"},{"location":"usage/#2-consumo-de-agua-semanal","title":"2. \ud83d\udcca Consumo de Agua Semanal","text":"<ul> <li>Visualiza ETo, kc, ETc, precipitaciones y consumo por tipo de riego.</li> <li>Exportaci\u00f3n a Excel</li> </ul>"},{"location":"usage/#3-generar-recomendacion","title":"3. \ud83e\uddee Generar Recomendaci\u00f3n","text":"<ul> <li>Ingreso manual del kc</li> <li>Obtenci\u00f3n autom\u00e1tica de datos de ETo mediante crawler</li> <li>Validaci\u00f3n de datos faltantes</li> <li>Previsualizaci\u00f3n antes de guardar</li> </ul>"},{"location":"usage/#4-clima-semanal","title":"4. \ud83c\udf26\ufe0f Clima Semanal","text":"<ul> <li>Vista previa de temperaturas y humedad</li> <li>Ingreso desde estaci\u00f3n INIA o DMC</li> <li>Modal interactivo para revisi\u00f3n y guardado</li> <li>Exportaci\u00f3n a Excel</li> </ul>"},{"location":"usage/#5-graficos","title":"5. \ud83d\udcc8 Gr\u00e1ficos","text":"<ul> <li>Grados D\u00eda Acumulado (por temporada o total)</li> <li>Exportaci\u00f3n a imagen</li> </ul>"},{"location":"usage/#4-gestion-de-usuarios","title":"\ud83d\udc64 4. Gesti\u00f3n de Usuarios","text":"<p>Solo visible para administradores.</p> <ul> <li>Crear, editar y desactivar usuarios</li> <li>Validaciones autom\u00e1ticas: RUT, correo, tel\u00e9fono, contrase\u00f1a</li> </ul>"},{"location":"usage/#5-flujo-del-crawler","title":"\ud83d\udd01 5. Flujo del Crawler","text":"<ol> <li>El administrador presiona \"Generar recomendaci\u00f3n\"</li> <li>Se ejecuta el crawler (Puppeteer) en backend</li> <li>Se obtienen ETo y fechas desde la estaci\u00f3n</li> <li>Se validan datos (m\u00e1ximo 2 faltantes con promedio)</li> <li>Se muestra previsualizaci\u00f3n</li> <li>Usuario guarda recomendaci\u00f3n manualmente</li> </ol>"},{"location":"usage/#6-recomendaciones","title":"\ud83d\udca1 6. Recomendaciones","text":"<ul> <li>Revisa la estaci\u00f3n configurada en cada zona</li> <li>Ingresa kc antes de generar recomendaciones</li> <li>Usa la vista de clima para comparar con a\u00f1os anteriores</li> <li>Exporta los datos para informes agr\u00edcolas</li> </ul> <p>Esta plataforma est\u00e1 pensada para facilitar la toma de decisiones en el riego t\u00e9cnico agr\u00edcola, asegurando eficiencia h\u00eddrica y respaldo en datos clim\u00e1ticos confiables.</p>"}]}